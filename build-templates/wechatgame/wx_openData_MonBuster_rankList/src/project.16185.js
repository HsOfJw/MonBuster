__require=function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof __require&&__require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return a(n||e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof __require&&__require,i=0;i<r.length;i++)a(r[i]);return a}({RankListItem:[function(e,t,n){"use strict";cc._RF.push(t,"b8fb8e8vwpNDJTqWUfYitPQ","RankListItem");var r=e("Util");cc.Class({extends:cc.Component,properties:{levelId:{displayName:"\u540d\u6b21",default:null,type:cc.Label},headSprite:{displayName:"\u5934\u50cf",default:null,type:cc.Sprite},nickname:{displayName:"\u6635\u79f0",default:null,type:cc.Label},userLevel:{displayName:"\u73a9\u5bb6\u5f53\u524d\u7b49\u7ea7",default:null,type:cc.Label}},onLoad:function(){},setRankListItemData:function(e,t){this.levelId.string="NO."+e,this.levelId.node.color=1===e?new cc.Color(255,121,0):e<4?new cc.Color(60,60,60):new cc.Color(144,144,144);var n=t.avatarUrl;r.loadRemoteSprite(n,this.headSprite.node),this.nickname.string=t.nickname,this.userLevel.string=t.KVDataList[0].value}}),cc._RF.pop()},{Util:"Util"}],RankList:[function(e,t,n){"use strict";cc._RF.push(t,"d7e52oHPhNLBLuusCSmvkcg","RankList");var r=e("Util");cc.Class({extends:cc.Component,properties:{contentNode:{displayName:"\u5185\u5bb9\u8282\u70b9",default:null,type:cc.Node},rankListItem:{displayName:"\u5b50\u9884\u5236\u4f53",default:null,type:cc.Prefab},levelSign:{displayName:"\u662f\u5426\u4e0a\u699c",default:null,type:cc.Label},headSprite:{displayName:"\u5934\u50cf",default:null,type:cc.Sprite},nickname:{displayName:"\u6635\u79f0",default:null,type:cc.Label},userLevel:{displayName:"\u73a9\u5bb6\u5f53\u524d\u7b49\u7ea7",default:null,type:cc.Label}},onLoad:function(){},start:function(){var e=this;window.wx&&wx.onMessage(function(t){switch(t.message){case"FriendRankList":e._showFriendRankList();break;case"setUserStorage":e._setUserStorage(t.storageData);break;default:console.log("\u5411\u5b50\u57df\u53d1\u9001\u7684\u6d88\u606f\u4f53 \u5f02\u5e38",t.message)}})},_setUserStorage:function(e){var t=JSON.parse(e);if(void 0!==window.wx){var n=[{key:"MonBuster_MaxScore",value:t.levelInfo},{key:"MonBuster_TotalStar",value:t.totalStar.toString()}];wx.setUserCloudStorage({KVDataList:n})}},_showFriendRankList:function(){console.log("\u83b7\u53d6\u597d\u53cb\u6392\u884c");var e=this;wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(t){console.log("\u83b7\u53d6\u5f53\u524d\u7528\u6237\u6258\u7ba1\u6570\u636e",t),wx.getFriendCloudStorage({keyList:["MonBuster_MaxScore","MonBuster_TotalStar"],complete:function(n){console.log("\u62c9\u53d6\u5f53\u524d\u7528\u6237\u6240\u6709\u540c\u73a9\u597d\u53cb\u7684\u6258\u7ba1\u6570\u636e",n),e._TraverseItemPage(t.data[0],n.data)}})}})},_TraverseItemPage:function(e,t){this.sortList(t,!1),this.contentNode.removeAllChildren();for(var n=0;n<t.length;n++){var r=cc.instantiate(this.rankListItem),a=r.getComponent("RankListItem");a&&a.setRankListItemData(n+1,t[n]),this.contentNode.addChild(r),t[n].nickname===e.nickName&&t[n].avatarUrl===e.avatarUrl&&(console.log("\u6392\u884c\u699c\u5c55\u793a\u81ea\u5df1\u7684\u6570\u636e",n+1,t[n]),this._initMyselfInfo(n+1,t[n]))}},_initMyselfInfo:function(e,t){parseInt(e)<101?this.levelSign.string="\u4e0a\u699c":this.levelSign.string="\u672a\u4e0a\u699c";var n=t.avatarUrl;r.loadRemoteSprite(n,this.headSprite.node),this.nickname.string=t.nickname?t.nickname.slice(0,5):"",this.userLevel.string=this.userLevel.string=t.KVDataList[0].value},sortList:function(e,t){return e.sort(function(e,n){for(var r=0,a=e.KVDataList,o=0;o<a.length;o++)"MonBuster_TotalStar"==a[o].key&&(r=parseInt(a[o].value));var i=0;a=n.KVDataList;for(var s=0;s<a.length;s++)"MonBuster_TotalStar"==a[s].key&&(i=parseInt(a[s].value));return t?parseInt(r)-parseInt(i):parseInt(i)-parseInt(r)}),e}}),cc._RF.pop()},{Util:"Util"}],Util:[function(e,t,n){"use strict";cc._RF.push(t,"62680jGcKVBYpXFwhAwXF7G","Util"),t.exports={log:function(e){console.log("-------------------------------------------"),console.log(e),console.log("*******************************************")},prefix:function(e,t){return e.toString().length>=t?e:(Array(t).join("0")+e).slice(-t)},formatTimeRemainTime:function(e){var t=parseInt(e/1e3),n=Math.floor(t/3600),r=Math.floor(t%3600/60),a=Math.floor(t%3600%60);return(n=this.prefix(n,2))+":"+(r=this.prefix(r,2))+":"+(a=this.prefix(a,2))},randomByMaxValue:function(e){return Math.floor(Math.random()*e)},randomNum:function(e){var t=(new Date).getSeconds()+Math.floor(100*Math.random()),n=this.rnd(t);return Math.ceil(n*e)},rnd:function(e){return(e=(9301*e+49297)%233280)/233280},removeElementsFromArray:function(e,t){for(var n=-1,r=e.length,a=0;a<r;a++)if(e[a]===t){n=a;break}n>=0&&e.splice(n,1)},makeRdmStr:function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,r="",a=0;a<e;a++)r+=t.charAt(Math.floor(Math.random()*n));return r},numCutOut:function(e,t){var n=(parseInt(e*Math.pow(10,t))/Math.pow(10,t)).toString(),r=n.split(".");if(1===r.length){n+=".";for(var a=0;a<t;a++)n+="0"}else if(2===r.length)for(var o=r[1].length;o<t;o++)n+="0";return n},getUnixTime:function(){return Math.round((new Date).getTime()/1e3)},deepCopy:function(e){for(var t=[],n=0,r=e.length;n<r;n++)e[n]instanceof Array?t[n]=this.deepCopy(e[n]):t[n]=e[n];return t},getRandomItemFromArray:function(e,t){var n=[];for(var r in e)n.push(e[r]);for(var a=[],o=0;o<t&&n.length>0;o++){var i=Math.floor(Math.random()*n.length);a[o]=n[i],n.splice(i,1)}return a},getNowTime:function(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},getIP:function(){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&e.status>=200&&e.status<400&&console.log(e.responseText)},e.open("GET","http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js",!0),e.send()},loadRemoteSprite:function(e,t){if(window.wx){var n=wx.createImage();n.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(n),e.handleLoadedTexture();var r=new cc.SpriteFrame(e);t.setScale(t.width/r.getOriginalSize().width),t.getComponent(cc.Sprite).spriteFrame=r}catch(e){cc.log("\u52a0\u8f7d\u8fdc\u7a0b\u56fe\u6807\u5931\u8d25,\u9519\u8bef\u4fe1\u606f\u4e3a",e),t.active=!1}},n.src=e}},reZorderToTop:function(e){var t=e.parent.children.length;e.setLocalZOrder(t)}},cc._RF.pop()},{}]},{},["Util","RankList","RankListItem"]);